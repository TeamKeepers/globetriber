{% extends "base.html.twig" %}

{% use "bootstrap_4_layout.html.twig" %}

{% block title %} Recherche d'un lieu {% endblock%}

{% block body %}
 
    {{ form_start(form) }}
        {{ form_widget(form) }}
    {{ form_end(form) }}

    <h2>Affichage Maps</h2>
    
    <div id="map"></div>
    <h3>Bienvenue sur la liste des produits</h3>

    {# generate place results #}
    <ul>
        {% for result in results %}
            <li>
                {{ result.title }} {{ result.description }}
                   
            </li>
        {% endfor %}
    </ul>
       
    
    <script >
      var markers;
      var map;
       function initMap(){
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom : 13,
                center:{lat: 48.8566, lng:2.3522},
                mapTypeId: google.maps.MapTypeId.ROADMAP         
        });   
            
        var markers = new Array ();
        
        {% for result in results %}
            markers.push(new google.maps.Marker({
                position:{
                    lat : {{result.lat}},
                    lng : {{result.lng}},
                    },
                
                map: map,
            
                animation: google.maps.Animation.DROP,
               
            }));
        {% endfor %}
        var bounds = new google.maps.LatLngBounds();
        markers.forEach(function(result){
            bounds.extend(result.position);
            map.fitBounds(bounds);
            map.setZoom(13); // Not working for now
        })     
        
    }
    </script>
     <script type="text/javascript" async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyLL_wAkO_vMlDVj_AEXH9HUKJ7lVVNTY&callback=initMap">
    </script>
 
    
{% endblock%}



